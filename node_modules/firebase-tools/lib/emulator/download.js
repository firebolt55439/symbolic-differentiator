"use strict";
var fs = require("fs-extra");
var request = require("request");
var emulatorConstants = require("./constants");
var utils = require("../utils");
module.exports = function (name) {
    return new Promise(function (resolve, reject) {
        utils.logLabeledBullet(name, "downloading emulator...");
        var emulator = emulatorConstants.emulators[name];
        fs.ensureDirSync(emulator.cacheDir);
        var req = request.get(emulator.remoteUrl);
        var writeStream = fs.createWriteStream(emulator.localPath);
        req.on("error", function (err) { return reject(err); });
        req.on("end", function () {
            writeStream.close();
            fs.chmodSync(emulator.localPath, 493);
            resolve();
        });
        req.pipe(writeStream);
    });
};
//# sourceMappingURL=download.js.map